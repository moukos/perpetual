	.text
	.globl P2
	.type P2, @function

P2:
	pushq %rbp
	pushl %r12d
	pushq %r13
	pushq %r14
	movq %rsp, %rbp
	
	movq (%rdi), %r8	# ptr to x
	movq 8(%rdi), %r9	# ptr to y
	movq 16(%rdi), %r10  	# ptr to buf[0]
	movl 24(%rdi), %r11d	# no of iterations
	movl 28(%rdi), %r12d	# no of threads
	movq $0, %r13		# loop index
	movq $1, %r14		# write value
	jmp .L2
.L3:

	# LB Thread 2
	movq (%r9), %rcx	# read y
	movq %r14, (%r8)	# write x

	# Store in correct location in buf
	movq %rcx, (%r10, %r13, 4)

	# Increment loop index and write value 
	incq %r13
	incq %r14
.L2:
	cmpl %r11d,%r13
	jl .L3

	popq %r14
	popq %r13
	popl %r12d
	popq %rbp
	ret
